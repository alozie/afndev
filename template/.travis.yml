# Note that the example .travis.yml file for child projects lives in /install.
sudo: false
language: php

php:
  - 5.5

cache:
  bundler: true
  apt: true
  directories:
  - "$HOME/.composer/cache"
  - "$HOME/.drush/cache"

addons:
  ssh_known_hosts:
  # - svn-4786.devcloud.hosting.acquia.com

notifications:
  # Replace this with project slack token.
  # slack: acquia:KKfgpOkDhcO26Erv5uoZMfdP4

before_install:
  - composer selfupdate
  - git config --global user.name "Travis-CI"
  - git config --global user.email "noreply@travis-ci.org"
  - mysql -e 'CREATE DATABASE drupal;'

install:
  - composer install
  - export PATH=$PATH:$TRAVIS_BUILD_DIR/bin

before_script:
  # Clear drush release history cache, to pick up new releases.
  - rm -f ~/.drush/cache/download/*---updates.drupal.org-release-history-*

script:
  - phing -f build/phing/build.xml -Dbehat:run-server=true $TEST_SUITE

after_success:
  # Watch for successfully changes to `7.x` branch on GitHub, build and deploy
  # to `build` branch on Acquia Cloud.
  # - if [ "${TRAVIS_PULL_REQUEST}" = "false" ] && [ "${TRAVIS_BRANCH}" = "master" ]; then ./task.sh deploy:build -Ddeploy.branch=build -Ddeploy.buildID=$TRAVIS_BUILD_ID; fi;
